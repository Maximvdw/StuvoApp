<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" type="text/css" href="css/agenda.css" />
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/hammer.min.js"></script>
        <script type="text/javascript" src="js/hook.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <title>Stuvo App</title>
        
        <script>
			$( document ).ready(function() {
				loadAgenda();
			
				var menuElement = document.getElementById('header-container');
				var menu = document.getElementById('mobilemenu');
				Hammer(menuElement).on("swipeleft", function() {
				    // OPEN MENU
				    menuOpen();
				});
				Hammer(menuElement).on("swiperight", function() {
				    // OPEN MENU
				    menuClose();
				});
				Hammer(menu).on("swiperight", function() {
				    // OPEN MENU
				    menuClose();
				});
				
				// Callback
				$('#hook').hook({
				  reloadPage: false,
				  reloadEl: function(){
				    loadAgenda();
				  }
				});
			});
			function loadAgenda(){
				var agendaElement = document.getElementById('agenda');
				agendaElement.innerHTML = "<div class=\"loading\"></div>";
				$.getJSON( "http://srv5.mvdw-software.com/workspace/Stuvo/backend/html/agenda.php", function( data ) {
					agendaElement.innerHTML = "";
					var agenda = "";
					$.each( data['events'], function( month, eventData ) {
						agendaElement.innerHTML += "<h2>" + month + "</h2>";
						$.each(eventData, function( eventId, event ) {
							var agendaItem = "";
							agendaItem += "<div class=\"agenda-item\">";
							
							agendaItem += "<div class=\"agenda-name\">"
							agendaItem += "<span class=\"agenda-date\">";
							agendaItem += event['date'];
							agendaItem += "</span>";
							agendaItem += event['name'];
							agendaItem += "</div>";
							
							// Landscape data
							agendaItem += "<div class=\"agenda-info-landscape\">";
							agendaItem += event['description'];
							agendaItem += "</div>";
							
							// Extra info panel
							agendaItem += "<div class=\"agenda-info-container closed\" onclick=\"agendaInfot(his);\">";
							agendaItem += "<div class=\"agenda-info\">";
							agendaItem += "</div>";
							agendaItem += "</div>";
							
							agendaItem += "</div>";
							agendaElement.innerHTML += agendaItem;
						});
					});
				});
			}
			
			function menuToggle(){
				var menu = document.getElementById('mobilemenu');
				if (menu.className == ""){
					menuClose();
				}else{
					menuOpen();
				}
			}
			function menuOpen(){
				var menu = document.getElementById('mobilemenu');
				menu.className = "";
			}
			function menuClose(){
				var menu = document.getElementById('mobilemenu');
				menu.className = "closed";
			}
			function agendaInfo(e){
				var agendaInfo = e.getElementsByClassName('agenda-info-container');
				if (agendaInfo.className == "closed"){
					agendaInfo.className = "";
				}else{
					agendaInfo.className = "closed";
				}
			}
        </script>
    </head>
    <body>
	    <div id="header-container">
			<div id="header">
				<a id="logo" href="/"></a>
				<a id="mobile" href="#mobilemenu" onclick="menuToggle();"></a>
			</div>
		</div>
		<div id="mobilemenu" class="closed">
					
		</div>
		
		<div id="content">
			<button onclick="window.plugins.socialsharing.share('Message, image and link', null, 'https://www.google.nl/images/srpr/logo4w.png', 'http://www.x-services.nl')">message, image and link</button>
			<div class="hook" id="hook"></div>
			<h1>Agenda</h1>
			<div id="agenda">
				<div class="loading"></div>
			</div>
		</div>
    </body>
</html>
